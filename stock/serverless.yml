service: quizbells-stock
configValidationMode: warn

provider:
  name: aws
  runtime: nodejs18.x
  region: ap-northeast-2
  timeout: 900
  memorySize: 1024
  lambdaHashingVersion: 20201221
  iamRoleStatements:
    - Effect: Allow
      Action:
        - logs:CreateLogGroup
        - logs:CreateLogStream
        - logs:PutLogEvents
      Resource: "arn:aws:logs:*:*:*"

functions:
  stockGenerator:
    handler: lambda.handler
    events:
      - schedule:
          name: quizbells-stock-korea
          description: "Generate Korea stock posts every day at 09:00 KST"
          rate: cron(0 0 * * ? *)
          input:
            mode: all
            market: korea
      - schedule:
          name: quizbells-stock-us
          description: "Generate US stock posts every day at 22:00 KST"
          rate: cron(0 13 * * ? *)
          input:
            mode: all
            market: us
      - http:
          path: /stock/generate
          method: post
          cors: true
